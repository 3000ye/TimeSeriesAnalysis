[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "TimeSeriesAnalysis",
    "section": "",
    "text": "Preface",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#å…³äºæœ¬ç½‘é¡µ",
    "href": "index.html#å…³äºæœ¬ç½‘é¡µ",
    "title": "TimeSeriesAnalysis",
    "section": "å…³äºæœ¬ç½‘é¡µ",
    "text": "å…³äºæœ¬ç½‘é¡µ\næœ¬ä¹¦ä¸ºåŒ—äº¬å¤§å­¦æ•°å­¦ç§‘å­¦å­¦é™¢é‡‘èæ•°å­¦ç³»é‡‘èæ•°å­¦åº”ç”¨ç¡•å£«ã€Šé‡‘èæ—¶é—´åºåˆ—åˆ†æã€‹ï¼ˆæä¸œé£ï¼‰çš„é˜…è¯»ç¬”è®°ï¼ŒåŸæ–‡ç¤ºä¾‹ä»£ç ä½¿ç”¨ R è¯­è¨€è¿›è¡Œç¼–å†™ï¼Œæœ¬æ–‡å®ç°äº† Python è¯­è¨€ç‰ˆæœ¬ã€‚\nåŸæ–‡é“¾æ¥ï¼šã€Šé‡‘èæ—¶é—´åºåˆ—åˆ†æã€‹",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#æœ¬ä¹¦å†…å®¹",
    "href": "index.html#æœ¬ä¹¦å†…å®¹",
    "title": "TimeSeriesAnalysis",
    "section": "æœ¬ä¹¦å†…å®¹",
    "text": "æœ¬ä¹¦å†…å®¹\n\n\næ”¶ç›Šç‡ï¼Œå€ºåˆ¸ï¼Œæ³¢åŠ¨ç‡ï¼Œé‡‘èæ•°æ®ç¤ºä¾‹ï¼Œæ”¶ç›Šç‡åˆ†å¸ƒæ€§è´¨ï¼Œé‡‘èæ•°æ®å¯è§†åŒ–ï¼Œç»Ÿè®¡åˆ†å¸ƒå¤ä¹ ;\nçº¿æ€§æ—¶é—´åºåˆ—ï¼šæ¬¾å¹³ç¨³ï¼Œè‡ªç›¸å…³ç³»æ•°å‡½æ•°ï¼ŒACFçš„ç™½å™ªå£°æ£€éªŒï¼Œ AR, åç›¸å…³ç³»æ•°ï¼Œå®šé˜¶ä¸å‚æ•°ä¼°è®¡ï¼Œé¢„æµ‹ï¼ŒMAï¼Œ ARMA, ARIMAï¼Œå•ä½æ ¹è¿‡ç¨‹ï¼Œå•ä½æ ¹æ£€éªŒï¼Œ æŒ‡æ•°å¹³æ»‘æ–¹æ³•ï¼Œå­£èŠ‚æ¨¡å‹ï¼Œ å›å½’æ¨¡å‹çš„åºåˆ—ç›¸å…³è¯¯å·®é¡¹ï¼Œåæ•´ï¼Œ é•¿è®°å¿†æ¨¡å‹ï¼Œæ¨¡å‹æ¯”è¾ƒä¸æ¨¡å‹å¹³å‡ çº¿æ€§æ—¶é—´åºåˆ—çš„æ¡ˆä¾‹ç ”ç©¶;\nèµ„äº§æ³¢åŠ¨ç‡ï¼ŒARCHæ•ˆåº”ï¼ŒARCHæ¨¡å‹ï¼ŒGARCHæ¨¡å‹ï¼ŒIGARCHæ¨¡å‹ï¼Œ GARCH-Mæ¨¡å‹ï¼ŒEGARCHæ¨¡å‹, TGARCHæ¨¡å‹, APARCHæ¨¡å‹ï¼Œ éå¯¹ç§°GARCHæ¨¡å‹ï¼Œéšæœºæ³¢åŠ¨ç‡æ¨¡å‹ æ³¢åŠ¨ç‡æ¨¡å‹æ¡ˆä¾‹ç ”ç©¶;\nå¤šå…ƒæ—¶é—´åºåˆ—çš„åŸºç¡€çŸ¥è¯†å’ŒVARæ¨¡å‹ï¼Œ åæ•´å’Œåæ•´æ£€éªŒï¼Œæ ¼å…°æ°å› æœæ€§;\nçŠ¶æ€ç©ºé—´æ¨¡å‹ä»‹ç»ã€‚",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "Ch1/1-é‡‘èæ•°æ®åŠå…¶ç‰¹å¾.html",
    "href": "Ch1/1-é‡‘èæ•°æ®åŠå…¶ç‰¹å¾.html",
    "title": "1Â  é‡‘èæ•°æ®åŠå…¶ç‰¹å¾",
    "section": "",
    "text": "1.1 èµ„äº§æ”¶ç›Šç‡",
    "crumbs": [
      "<span class='chapter-number'>1</span>Â  <span class='chapter-title'>é‡‘èæ•°æ®åŠå…¶ç‰¹å¾</span>"
    ]
  },
  {
    "objectID": "Ch1/1-é‡‘èæ•°æ®åŠå…¶ç‰¹å¾.html#å€ºåˆ¸æ”¶ç›Šå’Œä»·æ ¼",
    "href": "Ch1/1-é‡‘èæ•°æ®åŠå…¶ç‰¹å¾.html#å€ºåˆ¸æ”¶ç›Šå’Œä»·æ ¼",
    "title": "1Â  é‡‘èæ•°æ®åŠå…¶ç‰¹å¾",
    "section": "1.2 å€ºåˆ¸æ”¶ç›Šå’Œä»·æ ¼",
    "text": "1.2 å€ºåˆ¸æ”¶ç›Šå’Œä»·æ ¼",
    "crumbs": [
      "<span class='chapter-number'>1</span>Â  <span class='chapter-title'>é‡‘èæ•°æ®åŠå…¶ç‰¹å¾</span>"
    ]
  },
  {
    "objectID": "Ch1/1-é‡‘èæ•°æ®åŠå…¶ç‰¹å¾.html#éšå«æ³¢åŠ¨ç‡",
    "href": "Ch1/1-é‡‘èæ•°æ®åŠå…¶ç‰¹å¾.html#éšå«æ³¢åŠ¨ç‡",
    "title": "1Â  é‡‘èæ•°æ®åŠå…¶ç‰¹å¾",
    "section": "1.3 éšå«æ³¢åŠ¨ç‡",
    "text": "1.3 éšå«æ³¢åŠ¨ç‡",
    "crumbs": [
      "<span class='chapter-number'>1</span>Â  <span class='chapter-title'>é‡‘èæ•°æ®åŠå…¶ç‰¹å¾</span>"
    ]
  },
  {
    "objectID": "Ch1/1-é‡‘èæ•°æ®åŠå…¶ç‰¹å¾.html#æ”¶ç›Šç‡åˆ†å¸ƒç‰¹æ€§å’Œæ¢ç´¢æ€§åˆ†æ",
    "href": "Ch1/1-é‡‘èæ•°æ®åŠå…¶ç‰¹å¾.html#æ”¶ç›Šç‡åˆ†å¸ƒç‰¹æ€§å’Œæ¢ç´¢æ€§åˆ†æ",
    "title": "1Â  é‡‘èæ•°æ®åŠå…¶ç‰¹å¾",
    "section": "1.4 æ”¶ç›Šç‡åˆ†å¸ƒç‰¹æ€§å’Œæ¢ç´¢æ€§åˆ†æ",
    "text": "1.4 æ”¶ç›Šç‡åˆ†å¸ƒç‰¹æ€§å’Œæ¢ç´¢æ€§åˆ†æ",
    "crumbs": [
      "<span class='chapter-number'>1</span>Â  <span class='chapter-title'>é‡‘èæ•°æ®åŠå…¶ç‰¹å¾</span>"
    ]
  },
  {
    "objectID": "Ch1/1-é‡‘èæ•°æ®åŠå…¶ç‰¹å¾.html#æ”¶ç›Šç‡çš„åˆ†å¸ƒç‰¹æ€§",
    "href": "Ch1/1-é‡‘èæ•°æ®åŠå…¶ç‰¹å¾.html#æ”¶ç›Šç‡çš„åˆ†å¸ƒç‰¹æ€§",
    "title": "1Â  é‡‘èæ•°æ®åŠå…¶ç‰¹å¾",
    "section": "1.5 æ”¶ç›Šç‡çš„åˆ†å¸ƒç‰¹æ€§",
    "text": "1.5 æ”¶ç›Šç‡çš„åˆ†å¸ƒç‰¹æ€§",
    "crumbs": [
      "<span class='chapter-number'>1</span>Â  <span class='chapter-title'>é‡‘èæ•°æ®åŠå…¶ç‰¹å¾</span>"
    ]
  },
  {
    "objectID": "Ch1/1-é‡‘èæ•°æ®åŠå…¶ç‰¹å¾.html#é‡‘èæ•°æ®çš„å›¾å½¢",
    "href": "Ch1/1-é‡‘èæ•°æ®åŠå…¶ç‰¹å¾.html#é‡‘èæ•°æ®çš„å›¾å½¢",
    "title": "1Â  é‡‘èæ•°æ®åŠå…¶ç‰¹å¾",
    "section": "1.6 é‡‘èæ•°æ®çš„å›¾å½¢",
    "text": "1.6 é‡‘èæ•°æ®çš„å›¾å½¢",
    "crumbs": [
      "<span class='chapter-number'>1</span>Â  <span class='chapter-title'>é‡‘èæ•°æ®åŠå…¶ç‰¹å¾</span>"
    ]
  },
  {
    "objectID": "Ch1/1-é‡‘èæ•°æ®åŠå…¶ç‰¹å¾.html#é‡‘èæ•°æ®å¸¸ç”¨çš„åˆ†å¸ƒ",
    "href": "Ch1/1-é‡‘èæ•°æ®åŠå…¶ç‰¹å¾.html#é‡‘èæ•°æ®å¸¸ç”¨çš„åˆ†å¸ƒ",
    "title": "1Â  é‡‘èæ•°æ®åŠå…¶ç‰¹å¾",
    "section": "1.7 é‡‘èæ•°æ®å¸¸ç”¨çš„åˆ†å¸ƒ",
    "text": "1.7 é‡‘èæ•°æ®å¸¸ç”¨çš„åˆ†å¸ƒ",
    "crumbs": [
      "<span class='chapter-number'>1</span>Â  <span class='chapter-title'>é‡‘èæ•°æ®åŠå…¶ç‰¹å¾</span>"
    ]
  },
  {
    "objectID": "Ch2/2-çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹.html",
    "href": "Ch2/2-çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹.html",
    "title": "2Â  çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹",
    "section": "",
    "text": "2.1 ä»‹ç»\nè¯¾ç¨‹é‡‡ç”¨è”¡ç‘èƒ¸ï¼ˆRuey S. Tsayï¼‰çš„ã€Šé‡‘èæ•°æ®åˆ†æå¯¼è®ºï¼šåŸºäºRè¯­è¨€ã€‹(Tsay 2013) ï¼ˆAn Introduction to Analysis of Financial Data with Rï¼‰ä½œä¸ºä¸»è¦æ•™æä¹‹ä¸€ã€‚ â€œçº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹â€è¿™ä¸€éƒ¨åˆ†æ˜¯æ•™æçš„ç¬¬äºŒç« å’Œç¬¬ä¸‰ç« çš„æˆè¯¾ç¬”è®°ï¼Œ æœ¬ç« è®²æˆæ—¶é—´åºåˆ—çš„çº¿æ€§æ¨¡å‹ï¼ŒåŒ…æ‹¬ï¼š",
    "crumbs": [
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "Ch2/2-çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹.html#ä»‹ç»",
    "href": "Ch2/2-çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹.html#ä»‹ç»",
    "title": "2Â  çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹",
    "section": "",
    "text": "ä¸€äº›åŸºæœ¬æ¦‚å¿µ\nAR, MA, ARMAæ¨¡å‹\nå•ä½æ ¹è¿‡ç¨‹\næŒ‡æ•°å¹³æ»‘\nå­£èŠ‚æ¨¡å‹\nå›å½’æ¨¡å‹ä¸­è¯¯å·®é¡¹æœ‰åºåˆ—ç›¸å…³çš„å¤„ç†\né•¿è®°å¿†çš„åˆ†æ•°é˜¶å·®åˆ†æ¨¡å‹\næ¨¡å‹æ¯”è¾ƒ\nå®ä¾‹åˆ†æ\n\n\n2.1.1 ä¾‹å­ï¼šå¯å£å¯ä¹å…¬å¸ç›ˆåˆ©æ•°æ®\nåºåˆ—ä»ä½“ç°å‡ºç¼“æ…¢çš„ã€éå•è°ƒçš„ä¸Šå‡è¶‹åŠ¿ï¼Œåˆæœ‰æ˜æ˜¾çš„æ¯å¹´çš„å‘¨æœŸå˜åŒ–ï¼ˆç§°ä¸ºå­£èŠ‚æ€§ï¼‰ï¼Œ è¿˜æœ‰çŸ­æœŸçš„æ³¢åŠ¨ï¼š\n\n\nCode\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nraw_data = []\nwith open(\"../ftsdata/q-ko-earns8309.txt\", \"r\", encoding=\"utf-8\") as file:\n    for line in file.readlines():\n        line = line.strip(\"\\n\").strip(\" \").replace(\"\\t\", \" \").split(\" \")\n        line = list(filter(lambda x: x != \"\", line))\n        raw_data.append(line)\ndata = pd.DataFrame(raw_data[1:], columns=raw_data[0])\n\n\ndata[\"pends\"] = pd.to_datetime(data[\"pends\"], format=\"%Y%m%d\")\ndata[\"anntime\"] = pd.to_datetime(data[\"anntime\"], format=\"%Y%m%d\")\ndata[\"value\"] = pd.to_numeric(data[\"value\"])\n\nplt.figure(figsize=(8, 4))\nplt.plot(data[\"pends\"], data['value'], label='Coca Kola Quarterly Return', color='green')\nplt.title('Coca Kola Quarterly Return', fontsize=16)\nplt.grid(True)\nplt.legend()\nplt.show()\n\n\n\n\n\n\n\n\n\næ ‡å‡ºä¸åŒå­£èŠ‚çš„æ•°æ®ç‚¹ï¼Œå¯ä»¥çœ‹å‡ºï¼Œæ¯å¹´ä¸€èˆ¬å†¬å­£å’Œæ˜¥å­£æœ€ä½ï¼Œ å¤å­£æœ€é«˜ï¼Œç§‹å­£ä»‹äºå¤å­£å’Œå†¬å­£ä¹‹é—´ï¼š\n\n\nCode\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nraw_data = []\nwith open(\"../ftsdata/q-ko-earns8309.txt\", \"r\", encoding=\"utf-8\") as file:\n    for line in file.readlines():\n        line = line.strip(\"\\n\").strip(\" \").replace(\"\\t\", \" \").split(\" \")\n        line = list(filter(lambda x: x != \"\", line))\n        raw_data.append(line)\ndata = pd.DataFrame(raw_data[1:], columns=raw_data[0])\n\n\ndata[\"pends\"] = pd.to_datetime(data[\"pends\"], format=\"%Y%m%d\")\ndata[\"anntime\"] = pd.to_datetime(data[\"anntime\"], format=\"%Y%m%d\")\ndata[\"value\"] = pd.to_numeric(data[\"value\"])\n\ndata['Date'] = pd.to_datetime(data['pends'])\ndata.set_index('Date', inplace=True)\n\ndata['Year'] = data.index.year\ndata['Quarter'] = data.index.quarter\n\ncpal = ['green', 'red', 'yellow', 'black']\n\nplt.figure(figsize=(8, 8))\n\nplt.plot(data.index, data['value'], label='Coca Kola Quarterly Return', color='gray')\n\nfor i, row in data.iterrows():\n    plt.scatter(row.name, row['value'], color=cpal[row['Quarter'] - 1], s=50)\n\nplt.title('Coca Kola Quarterly Return', fontsize=16)\nplt.grid(True)\n\nquarter_labels = ['Spring', 'Summer', 'Autumn', 'Winter']\nplt.legend([plt.Line2D([0], [0], marker='o', color='w', markerfacecolor=cpal[i], markersize=10) for i in range(4)],\n           quarter_labels,\n           title='Quarter')\n\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\n2.1.2 ä¾‹å­ï¼šæ ‡æ™®500æŒ‡æ•°æœˆå¯¹æ•°æ”¶ç›Šç‡\næ”¶ç›Šç‡åœ¨0ä¸Šä¸‹æ³¢åŠ¨ï¼Œé™¤äº†ä¸ªåˆ«æ—¶å€™åŸºæœ¬åœ¨æŸä¸ªæ³¢åŠ¨èŒƒå›´ä¹‹å†…ï¼š\n\n\nCode\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nraw_data = []\nwith open(\"../ftsdata/m-ibmsp-2611.txt\", \"r\", encoding=\"utf-8\") as file:\n    for line in file.readlines():\n        line = line.strip(\"\\n\").strip(\" \").replace(\"\\t\", \" \").split(\" \")\n        line = list(filter(lambda x: x != \"\", line))\n        raw_data.append(line)\ndata = pd.DataFrame(raw_data[1:], columns=raw_data[0])\n\ndata[\"date\"] = pd.to_datetime(data[\"date\"], format=\"%Y%m%d\")\ndata[\"ibm\"] = pd.to_numeric(data[\"ibm\"])\ndata[\"sp\"] = pd.to_numeric(data[\"sp\"])\ndata.head()\n\nplt.figure(figsize=(8, 4))\nplt.plot(data[\"date\"], data['sp'], label='S&P 500 Monthly Returns', color='green')\nplt.title('S&P 500 Monthly Returns', fontsize=16)\nplt.grid(True)\nplt.legend()\nplt.show()",
    "crumbs": [
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "Ch2/2-çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹.html#å¹³ç¨³æ€§",
    "href": "Ch2/2-çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹.html#å¹³ç¨³æ€§",
    "title": "2Â  çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹",
    "section": "2.2 å¹³ç¨³æ€§",
    "text": "2.2 å¹³ç¨³æ€§\nä¾‹å­ï¼šæ ‡æ™®500æŒ‡æ•°æœˆå¯¹æ•°æ”¶ç›Šç‡æ‰€å±•ç¤ºçš„æ”¶ç›Šç‡æ›²çº¿åŸºæœ¬å‘ˆç°ä¸€ä¸ªåœ¨æ°´å¹³çº¿ï¼ˆä¸€èˆ¬æ˜¯ 0ï¼‰ä¸Šä¸‹æ³¢åŠ¨ï¼Œä¸”æ³¢åŠ¨èŒƒå›´åŸºæœ¬ä¸å˜ï¼Œè¿™æ ·çš„è¡¨ç°æ˜¯æ—¶é—´åºåˆ—ã€å¼±å¹³ç¨³åºåˆ—ã€‘çš„è¡¨ç°ã€‚\nä¾‹å­ï¼šå¯å£å¯ä¹å…¬å¸ç›ˆåˆ©æ•°æ®æ‰€å±•ç¤ºçš„ä»·æ ¼æ›²çº¿å‘ˆç°å‡ºæ°´å¹³çš„ä¸Šä¸‹èµ·ä¼ï¼Œå¦‚æœåˆ†æˆå‡ æ®µçš„è¯ï¼Œå„æ®µçš„å¹³å‡å€¼å·®è·è¾ƒå¤§ï¼Œè¿™è¡¨ç°å‡ºæ‹ã€éå¹³ç¨³ã€‘çš„ç‰¹æ€§ã€‚\næ—¶é—´åºåˆ—ï¼šè®¾æœ‰éšæœºå˜é‡åºåˆ— \\(\\{x_t,t=\\ldots,-2,-1,0,1,2,\\ldots\\}\\),ç§°å…¶ä¸ºä¸€ä¸ªæ—¶é—´åºåˆ—ã€‚å…¶ä¸­\\(x_t\\)æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œä¹Ÿå¯ä»¥å†™æˆå¤§å†™çš„\\(X_t\\)ã€‚æ—¶é—´åºåˆ—\\(\\{X_t\\}\\)ä¸¥æ ¼æ¥è¯´æ˜¯ä¸€ä¸ªäºŒå…ƒçš„å‡½æ•° \\(X(t,\\omega),t\\in\\mathbb{Z}(\\mathbb{Z}\\)è¡¨ç¤ºæ‰€æœ‰æ•´æ•°ç»„æˆçš„é›†åˆ), \\(\\omega \\in \\Omega\\), \\(\\Omega\\)è¡¨ç¤ºåœ¨ä¸€å®šçš„æ¡ä»¶ä¸‹æ‰€æœ‰å¯èƒ½çš„è¯•éªŒç»“æœçš„é›†åˆã€‚ç»æµå’Œé‡‘èä¸­çš„æ—¶é—´åºåˆ—æˆ‘ä»¬åªèƒ½è§‚å¯Ÿåˆ°å…¶ä¸­æŸä¸€ä¸ª\\(\\omega_0\\in\\Omega\\)å¯¹åº”çš„ç»“æœï¼Œç§°ä¸ºä¸€æ¡â€œè½¨é“â€ã€‚è€Œé’ˆå¯¹éšæœºå˜é‡çš„è®¸å¤šç†è®ºæ€§è´¨éƒ½æ˜¯åœ¨\\(\\omega\\in\\Omega\\)ä¸Šè®¨è®ºçš„ï¼Œæ¯”å¦‚\\(EX_t=\\int X_t(\\omega)P(d\\omega)\\)æ˜¯\\(X_t(\\omega)\\)å¯¹\\(\\omega\\in\\Omega\\)çš„å¹³å‡ã€‚\nä¸ºäº†èƒ½å¤Ÿç”¨ä¸€æ¡è½¨é“çš„è§‚æµ‹æ ·æœ¬å¾—åˆ°æ‰€æœ‰\\(\\omega\\in\\Omega\\)çš„æ€§è´¨ï¼Œéœ€è¦æ—¶é—´åºåˆ—æ»¡è¶³â€œéå†æ€§â€ã€‚\næ—¶é—´åºåˆ—çš„æ ·æœ¬ï¼šè®¾\\(\\{x_t,t=1,2,\\ldots,T\\}\\)æ˜¯æ—¶é—´åºåˆ—ä¸­çš„ä¸€æ®µã€‚ä»å°†\\(x_t\\)çœ‹æˆéšæœºå˜é‡ï¼Œä¹Ÿå¯ä»¥å†™æˆå¤§å†™ çš„\\(X_t\\)ã€‚å¦‚æœæœ‰äº†å…·ä½“æ•°å€¼ï¼Œé‚£ä¹ˆæ ·æœ¬å°±æ˜¯ä¸€æ¡è½¨é“ä¸­çš„ä¸€æ®µã€‚\nè‡ªåæ–¹å·®å‡½æ•°ï¼šæ—¶é—´åºåˆ—\\(\\{X_t\\}\\)ä¸­ä¸¤ä¸ªéšæœºå˜é‡çš„åæ–¹å·® \\(Cov(X_s,X_t)\\)å«åšè‡ªåæ–¹å·®ã€‚å¦‚æœ \\(Cov(X_s,X_t)=\\gamma_{|t-s|}\\)ä»…ä¾èµ–äº\\(t-s\\),åˆ™ç§° \\[\\gamma_k=\\mathrm{Cov}(X_{t-k},X_t),k=0,1,2,\\ldots \\]\nä¸ºæ—¶é—´åºåˆ—\\(\\{X_t\\}\\)çš„è‡ªåæ–¹å·®å‡½æ•°ã€‚å› ä¸ºCov\\(( X_s, X_t) =\\)Cov\\(( X_t, X_s)\\), æ‰€ä»¥\\(\\gamma_{-k}=\\gamma_k\\)ã€‚æ˜“è§ \\(\\gamma_0=\\mathrm{Var}(X_t)\\)ã€‚\nç”±Cauchy-Schwartzä¸ç­‰å¼ï¼š \\[|\\gamma_k|=|E[(X_{t-k}-\\mu)(X_t-\\mu)]|\\leq\\left(E(X_{t-k}-\\mu)^2\\:E(X_t-\\mu)^2\\right)^{1/2}=\\gamma_0\\]\nå¼±å¹³ç¨³åºåˆ—(å®½å¹³ç¨³åºåˆ—ï¼Œweakly stationary time series): å¦‚æœæ—¶é—´åºåˆ—\\(\\{X_t\\}\\)å­˜åœ¨æœ‰é™çš„äºŒé˜¶çŸ©ä¸”æ»¡è¶³ï¼š\n\n\\(EX_t= \\mu\\)ä¸\\(t\\)æ— å…³ï¼›\n\\(\\mathrm{Var}(X_t)=\\gamma_0\\)ä¸\\(t\\)æ— å…³ï¼›\n\\(\\gamma _{k}=\\)Cov\\(( X_t- k, X_{t})\\), \\(k= 1, 2, \\ldots\\)ä¸\\(t\\)æ— å…³ï¼Œ\n\nåˆ™ç§°\\(\\{X_t\\}\\)ä¸ºå¼±å¹³ç¨³åºåˆ—ã€‚\né€‚å½“æ¡ä»¶ä¸‹å¯ä»¥ç”¨æ—¶é—´åºåˆ—çš„æ ·æœ¬ä¼°è®¡è‡ªåæ–¹å·®å‡½æ•°ï¼Œè¿™æ˜¯ç”¨ä¸€æ¡è½¨é“çš„ä¿¡æ¯æ¨æ–­æ‰€æœ‰å®éªŒç»“æœ\\(\\Omega\\),ä¼°è®¡å…¬ å¼ä¸ºï¼š \\[\\hat{\\gamma}_k=\\frac{1}{T}\\sum_{t=k+1}^T(x_{t-k}-\\bar{x})(x_t-\\bar{x}),k=0,1,\\ldots,T-1\\]\nç§°\\(\\hat{\\gamma}_k\\)ä¸ºæ ·æœ¬è‡ªåæ–¹å·®ã€‚ æ³¨æ„è¿™é‡Œç”¨äº†\\(1/T\\)è€Œä¸æ˜¯\\(1/(T-k)\\),ç”¨\\(1/(T-k)\\)åœ¨è·å¾—æ— åæ€§çš„åŒæ—¶ä¼šé€ æˆä¸€ äº›ç†è®ºä¸Šçš„å›°éš¾ã€‚",
    "crumbs": [
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "Ch2/2-çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹.html#ç›¸å…³ç³»æ•°å’Œè‡ªç›¸å…³ç³»æ•°",
    "href": "Ch2/2-çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹.html#ç›¸å…³ç³»æ•°å’Œè‡ªç›¸å…³ç³»æ•°",
    "title": "2Â  çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹",
    "section": "2.3 ç›¸å…³ç³»æ•°å’Œè‡ªç›¸å…³ç³»æ•°",
    "text": "2.3 ç›¸å…³ç³»æ•°å’Œè‡ªç›¸å…³ç³»æ•°\n\n2.3.1 ç›¸å…³ç³»æ•°\n\n\nCode\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nraw_data = []\nwith open(\"../ftsdata/m-ibmsp-2611.txt\", \"r\", encoding=\"utf-8\") as file:\n    for line in file.readlines():\n        line = line.strip(\"\\n\").strip(\" \").replace(\"\\t\", \" \").split(\" \")\n        line = list(filter(lambda x: x != \"\", line))\n        raw_data.append(line)\ndata = pd.DataFrame(raw_data[1:], columns=raw_data[0])\n\ndata[\"date\"] = pd.to_datetime(data[\"date\"], format=\"%Y%m%d\")\ndata[\"ibm\"] = pd.to_numeric(data[\"ibm\"])\ndata[\"sp\"] = pd.to_numeric(data[\"sp\"])\ndata.head()\n\nplt.figure(figsize=(8, 4))\nplt.scatter(data[\"sp\"], data['ibm'], label='S&P 500 Monthly Returns', color='green')\nplt.xlabel(\"S&P\", fontsize=14)\nplt.ylabel(\"IBM\", fontsize=14)\nplt.grid(True)\nplt.legend()\nplt.show()\n\n\n\n\n\n\n\n\n\nä¸Šå›¾æ˜¯IBMè‚¡ç¥¨æœˆåº¦ç®€å•æ”¶ç›Šç‡å¯¹æ ‡æ™®500æ”¶ç›Šç‡çš„æ•£ç‚¹å›¾ï¼Œå¯ä»¥çœ‹å‡ºä¸¤è€…æœ‰æ˜æ˜¾çš„æ­£å‘ç›¸å…³å…³ç³»ã€‚\nä¸¤ä¸ªéšæœºå˜é‡\\(X\\)å’Œ\\(Y\\)çš„ç›¸å…³ç³»æ•°å®šä¹‰ä¸ºï¼š\n\\[\\rho(X,Y)=\\rho_{xy}=\\dfrac{\\mathrm{Cov}(X,Y)}{\\sqrt{\\mathrm{Var}(X)\\mathrm{Var}(Y)}}=\\dfrac{E[(X-\\mu_x)(Y-\\mu_y)]}{\\sqrt{E(X-\\mu_x)^2E(Y-\\mu_y)^2}}\\]\nå¦‚æœæœ‰\\((X,Y)\\)çš„ç‹¬ç«‹åŒåˆ†å¸ƒæ ·æœ¬\\(( x_t, y_t)\\), \\(t= 1, 2, \\ldots , T\\), å¯ä¼°è®¡ç›¸å…³ç³»æ•°ï¼ˆçš®å°”é€Šï¼ŒPearsonï¼‰ä¸ºï¼š\n\\[\\hat{\\rho}_{xy}=\\frac{\\sum_{t=1}^T(x_t-\\bar{x})(y_t-\\bar{y})}{\\sqrt{\\sum_{t=1}^T(x_t-\\bar{x})^2\\sum_{t=1}^T(y_t-\\bar{y})^2}}\\]\nå¯¹äºä¸ç‹¬ç«‹çš„æ ·æœ¬ï¼Œæ¯”å¦‚æ—¶é—´åºåˆ—æ ·æœ¬ï¼Œä¹Ÿå¯ä»¥è®¡ç®—ç›¸å…³ç³»æ•°ï¼Œå…¶ä¼°è®¡åˆç†æ€§éœ€è¦ä¸€äº›æ¨¡å‹å‡è®¾ã€‚ å¯¹äºè”åˆåˆ†å¸ƒéæ­£æ€çš„æƒ…å†µï¼Œæœ‰æ—¶ç›¸å…³ç³»æ•°ä¸èƒ½å¾ˆå¥½åœ°åæ˜ \\(X\\)å’Œ\\(Y\\)çš„æ­£å‘æˆ–è€…è´Ÿå‘çš„ç›¸å…³ã€‚ æ–¯çš®å°”æ›¼ (Spearman) ç›¸å…³ç³»æ•°æ˜¯è®¡ç®—\\(X\\)çš„æ ·æœ¬çš„ç§©(åæ¬¡)ä¸\\(Y\\)çš„æ ·æœ¬çš„ç§©ä¹‹é—´çš„ç›¸å…³ç³»æ•°ï¼Œä¹Ÿç§°ä¸ºSpearmam rank correlationã€‚\nå¦ä¸€ç§å¸¸ç”¨çš„éå‚æ•°ç›¸å…³ç³»æ•°æ˜¯è‚¯å¾·å°”tau(Kendallâ€™s \\(\\tau)\\)ç³»æ•°ï¼Œåæ˜ äº†ä¸€è‡´æ•°å¯¹å’Œéä¸€è‡´æ•°å¯¹ä¹‹é—´çš„å·®åˆ«ã€‚ å¯¹éšæœºå‘é‡\\((X,Y)\\),è®¾\\((X_1,Y_1),(X_2,Y_2)\\)ç›¸äº’ç‹¬ç«‹ä¸”è”åˆåˆ†å¸ƒä¸\\((X,Y)\\)è”åˆåˆ†å¸ƒç›¸åŒï¼Œå®šä¹‰\\(X\\)å’Œ\\(Y\\)çš„è‚¯ å¾·å°”tauç³»æ•°ä¸ºï¼š\n\\[\\tau=P\\left[(X_1-X_2)(Y_1-Y_2)&gt;0\\right]-P\\left[(X_1-X_2)(Y_1-Y_2)&lt;0\\right]\\]\nå³ä¸¤ä¸ªè§‚æµ‹çš„åˆ†é‡æ¬¡åºä¸€è‡´çš„æ¦‚ç‡å‡å»åˆ†é‡æ¬¡åºç›¸åçš„æ¦‚ç‡ã€‚ä¸€è‡´çš„æ¦‚ç‡è¶Šå¤§ï¼Œè¯´æ˜ä¸¤ä¸ªçš„æ­£å‘ç›¸å…³æ€§è¶Š å¼ºã€‚\nå¯¹ IBM æ”¶ç›Šç‡ä¸æ ‡æ™®æ”¶ç›Šç‡æ•°æ®è®¡ç®—è¿™ä¸‰ç§ç›¸å…³ç³»æ•°ï¼š\n\n\nCode\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nraw_data = []\nwith open(\"../ftsdata/m-ibmsp-2611.txt\", \"r\", encoding=\"utf-8\") as file:\n    for line in file.readlines():\n        line = line.strip(\"\\n\").strip(\" \").replace(\"\\t\", \" \").split(\" \")\n        line = list(filter(lambda x: x != \"\", line))\n        raw_data.append(line)\ndata = pd.DataFrame(raw_data[1:], columns=raw_data[0])\n\ndata[\"date\"] = pd.to_datetime(data[\"date\"], format=\"%Y%m%d\")\ndata[\"ibm\"] = pd.to_numeric(data[\"ibm\"])\ndata[\"sp\"] = pd.to_numeric(data[\"sp\"])\ndata.head()\n\npearson_corr = data['ibm'].corr(data['sp'])\nspearman_corr = data['ibm'].corr(data['sp'], method='spearman')\nkendall_corr = data['ibm'].corr(data['sp'], method='kendall')\n\nprint(\"Pearson correlation:\", pearson_corr)\nprint(\"Spearman correlation:\", spearman_corr)\nprint(\"Kendall correlation:\", kendall_corr)\n\n\nPearson correlation: 0.6395978546773113\nSpearman correlation: 0.6065788974589758\nKendall correlation: 0.4328065703413303\n\n\n\n\n2.3.2 è‡ªç›¸å…³å‡½æ•°ä¸ç™½å™ªå£°\nè®¾\\(\\{X_t\\}\\)ä¸ºå¼±å¹³ç¨³åºåˆ—ï¼Œ\\(\\{\\gamma_k\\}\\)ä¸ºè‡ªåæ–¹å·®å‡½æ•°ã€‚åˆ™\n\\[\\rho(X_{t-k},X_t)=\\frac{\\operatorname{Cov}(X_{t-k},X_t)}{\\sqrt{\\operatorname{Var}(X_{t-k})\\operatorname{Var}(X_t)}}=\\frac{\\gamma_k}{\\sqrt{\\gamma_0\\gamma_0}}=\\frac{\\gamma_k}{\\gamma_0},\\:k=0,1,\\ldots,\\:\\forall t\\]\nè®°\\(\\rho_k=\\gamma_k/\\gamma_0\\), è¿™æ˜¯\\(X_t-k\\)ä¸\\(X_t\\)çš„ç›¸å…³ç³»æ•°ä¸”ä¸\\(t\\)æ— å…³ï¼Œç§°\\(\\{\\rho_k,k=0,1,\\ldots\\}\\)ä¸ºæ—¶é—´åºåˆ—\\(\\{X_t\\}\\)çš„è‡ªç›¸å…³å‡½æ•° (Autocorrelation function, ACF)ã€‚\\(\\rho_0=1\\)ã€‚\nå¦‚æœå¼±å¹³ç¨³åºåˆ—\\(\\{X_t\\}\\)æ»¡è¶³\\(\\rho_k=0,k=1,2,\\ldots\\), ç§°\\(\\{X_t\\}\\)ä¸ºç™½å™ªå£°åºåˆ—ã€‚å¦‚æœéšæœºå˜é‡åºåˆ—\\(\\{X_t\\}\\)ç‹¬ç«‹ä¸”æœŸæœ›å’Œæ–¹å·®ä¸éšæ—¶é—´è€Œå˜ï¼Œåˆ™\\(\\{X_t\\}\\)æ˜¯ç™½å™ªå£°åºåˆ—ï¼Œç§°ä¸ºç‹¬ç«‹ç™½å™ªå£°ã€‚å¦‚æœç‹¬ç«‹ç™½å™ªå£°è¿˜æ˜¯åŒåˆ†å¸ƒçš„ï¼Œç§°ä¸ºç‹¬ç«‹åŒåˆ†å¸ƒç™½å™ªå£°ã€‚\né€‚å½“æ¡ä»¶ä¸‹\\(\\rho_k\\)å¯ä»¥ä»æ—¶é—´åºåˆ—æ ·æœ¬ä¼°è®¡ä¸ºï¼š\n\\[\\hat{\\rho}_k=\\frac{\\hat{\\gamma}_k}{\\hat{\\gamma}_0},\\:k=0,1,\\ldots \\]\n\\(\\hat{\\rho}_0=1\\)ã€‚ç§°\\(\\hat{\\rho}_k,k=1,2,\\ldots\\)ä¸ºæ ·æœ¬è‡ªç›¸å…³å‡½æ•°ã€‚\nå¦‚æœæ—¶é—´åºåˆ—ä¸¥å¹³ç¨³éå†ï¼Œåˆ™\\(\\hat{\\rho}_k\\)æ˜¯\\(\\rho_k\\)çš„å¼ºç›¸åˆä¼°è®¡ã€‚\nè‹¥\\(\\{X_t\\}\\)ä¸ºæœ‰äºŒé˜¶çŸ©çš„ç‹¬ç«‹åŒåˆ†å¸ƒéšæœºå˜é‡åˆ—ï¼Œåˆ™ \\(\\hat{\\rho}_k(k&gt;0)\\)æ¸è¿‘æœä»N\\((0,\\frac1T)\\)ã€‚\nå¦‚æœ\\(\\{\\varepsilon_t\\}\\)æ˜¯é›¶å‡å€¼ç‹¬ç«‹åŒåˆ†å¸ƒç™½å™ªå£°ï¼Œ\\(q\\)ä¸ºéè´Ÿæ•´æ•°ï¼Œ\\(\\{\\psi_j,j=0,1,\\ldots,q\\}\\)æ˜¯æ•°åˆ—ï¼Œ\\(\\psi_0=1\\), \\[X_t=\\mu+\\sum_{j=0}^q\\psi_j\\varepsilon_{t-j},\\:t\\in\\mathbb{Z},\\]\nåˆ™ä»\\(\\{X_t,t=1,\\ldots,T\\}\\)è®¡ç®—çš„ACFæ»¡è¶³ï¼šå½“\\(k&gt;q\\)æ—¶ï¼Œ\\(\\sqrt T\\hat{\\rho}_k\\)æ¸è¿‘æœä»\\(\\mathbb{N}(0,1+2\\sum_{j=0}^q\\rho_j^2)\\),è¿™ç§°ä¸ºBartlettå…¬å¼ã€‚\n\n2.3.2.1 ä¾‹å­ï¼šCRSP çš„ç¬¬10åˆ†ä½ç»„åˆçš„æœˆåº¦æ”¶ç›Šç‡\nç¬¬10åˆ†ä½ç»„åˆæ˜¯NYSEã€AMEXã€NASDAQå¸‚å€¼æœ€å°çš„10%è‚¡ç¥¨ç»„æˆçš„æŠ•èµ„ç»„åˆï¼Œ æ¯å¹´éƒ½é‡æ–°è°ƒæ•´ã€‚\n\nCRSPæ˜¯Center for Research in Security Prices, ä½äºChicago Boothã€‚\nNYSE(The New York Stock Exchange, çº½çº¦è¯åˆ¸äº¤æ˜“æ‰€),\nAMEX(American Stock Exchange, ç¾å›½è¯åˆ¸äº¤æ˜“æ‰€ï¼Œåœ¨çº½çº¦åå°”è¡—é™„è¿‘)ï¼Œ\nNASDAQ(National Association of Securities Dealers Automated Quotationsï¼Œçº³æ–¯è¾¾å…‹ï¼Œä½äºçº½çº¦)ã€‚\n\n\n\nCode\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nraw_data = []\nwith open(\"../ftsdata/m-dec12910.txt\", \"r\", encoding=\"utf-8\") as file:\n    for line in file.readlines():\n        line = line.strip(\"\\n\").strip(\" \").replace(\"\\t\", \" \").split(\" \")\n        line = list(filter(lambda x: x != \"\", line))\n        raw_data.append(line)\ndata = pd.DataFrame(raw_data[1:], columns=raw_data[0])\n\ndata[\"date\"] = pd.to_datetime(data[\"date\"], format=\"%Y%m%d\")\ndata.set_index(\"date\", inplace=True)\ndata = data.apply(pd.to_numeric)\ndata.head()\n\nplt.figure(figsize=(8, 4))\nplt.plot(data[\"dec10\"], label='CRSP Lower 10% Monthly Returns', color=\"green\")\nplt.title('CRSP Lower 10% Monthly Returns')\nplt.ylabel('d10')\nplt.legend()\nplt.show()\n\n\n\n\n\n\n\n\n\nç»˜åˆ¶æ—¶é—´åºåˆ—çš„è‡ªç›¸å…³å‡½æ•°å›¾ï¼ˆACFï¼‰ï¼š\n\n\nCode\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nraw_data = []\nwith open(\"../ftsdata/m-dec12910.txt\", \"r\", encoding=\"utf-8\") as file:\n    for line in file.readlines():\n        line = line.strip(\"\\n\").strip(\" \").replace(\"\\t\", \" \").split(\" \")\n        line = list(filter(lambda x: x != \"\", line))\n        raw_data.append(line)\ndata = pd.DataFrame(raw_data[1:], columns=raw_data[0])\n\ndata[\"date\"] = pd.to_datetime(data[\"date\"], format=\"%Y%m%d\")\ndata.set_index(\"date\", inplace=True)\ndata = data.apply(pd.to_numeric)\ndata.head()\n\nfrom statsmodels.graphics.tsaplots import plot_acf\n\nplt.figure(figsize=(8, 4))\nax = plt.gca()  # è·å–å½“å‰çš„è½´å¯¹è±¡\nplot_acf(data[\"dec10\"], ax=ax, lags=20)\nax.set_ylim(-0.25, 1)\nax.set_xlabel('Lag', fontsize=16)  # è®¾ç½®æ¨ªè½´æ ‡ç­¾\nplt.title('ACF of CRSP Lower 10% Monthly Returns')\nplt.show()\n\n\n\n\n\n\n\n\n\nåœ¨ ACF å›¾åƒä¸­ï¼ŒLag ç›¸å½“äº \\(k\\)ï¼ŒACF ç›¸å½“äº \\(\\hat{\\rho}_k\\)ã€‚\nACF å›¾ä¸­æ¨ªè½´ä¸Šä¸‹ä¸¤æ¡æ°´å¹³ä¸‹æ˜¯åœ¨ç‹¬ç«‹åŒåˆ†å¸ƒç™½å™ªå£°å‡è®¾ä¸‹çš„åŠ å‡ä¸¤å€æ ‡å‡†å·®ï¼Œå³ \\(\\pm\\frac2{\\sqrt{T}}\\)ã€‚å¦‚æœç‹¬ç«‹åŒåˆ†å¸ƒç™½å™ªå£°å‡è®¾æˆç«‹ï¼Œæ¯ä¸ª \\(\\hat{\\rho}_k\\) æœ‰ 95% ä»¥ä¸Šçš„æ¦‚ç‡è½å…¥è¿™ä¸¤æ¡çº¿ä¹‹é—´ã€‚\nACF å›¾ \\(k=0\\) å¤„æ€»å¯¹åº” \\(\\hat{\\rho}_0=1\\)ã€‚\nä¸Šå›¾çš„ \\(\\hat{\\rho}_1\\) å’Œ \\(\\hat{\\rho}_{12}\\) éƒ½è¶…å‡ºäº†ç•Œé™(å› ä¸ºæ˜¯æœˆåº¦æ•°ç›®ï¼Œæ¨ªè½´çš„å•ä½æ˜¯1/12ä¸ºä¸€ä¸ªæ—¶é—´ç‚¹)ã€‚ä»æ­¤å›¾å¯ä»¥è®¤ä¸ºæ­¤æŠ•èµ„ç»„åˆçš„æ”¶ç›Šç‡ä¸æ˜¯ç™½å™ªå£°ã€‚\n\n\n\n2.3.3 ç”¨å•ä¸ªè‡ªç›¸å…³ç³»æ•°ä½œç™½å™ªå£°æ£€éªŒ\nå¦‚æœ\\(\\{X_t\\}\\)æ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒç™½å™ªå£°ï¼Œåˆ™ \\(\\hat{\\rho}_k(k\\geq 1)\\) è¿‘ä¼¼ \\(N(0,1/T)\\)ã€‚è‹¥ \\(H_0\\) æ˜¯åºåˆ—ä¸ºç™½å™ªå£°ï¼Œå–ç»Ÿè®¡é‡ï¼š\n\\[t = \\sqrt{T}\\hat{\\rho}_k\\]\nå¦‚æœ\\(|t|&gt;\\)qnorm\\((1-\\alpha/2)\\)ï¼Œåˆ™æ‹’ç»ç™½å™ªå£°é›¶å‡è®¾ã€‚å®é™…ä¸­å¸¸å–\\(\\alpha=0.05\\), qnorm\\((1-\\alpha/2)\\approx2\\),å½“\\(\\hat{\\rho}_1\\)è¶…å‡º\\(\\pm2/\\sqrt T\\)åˆ™æ‹’ç»\\(H_0\\),æœ‰å¤šä¸ª\\(\\hat{\\rho}_k\\)è¶…å‡º\\(\\pm2/\\sqrt T\\)ä¹Ÿå¯æ‹’ç»\\(H_0\\),æœ‰ä¸€ä¸ª\\(t\\)ç»Ÿè®¡é‡å€¼å¾ˆå¤§(æ¯”å¦‚è¶…å‡º\\(\\pm3\\))ä¹Ÿå¯æ‹’ç»\\(H_0\\)ã€‚\nåœ¨åˆ¤æ–­\\(\\{X_t\\}\\)æ˜¯å¦\\(X_t=\\mu+\\sum_{j=0}^q\\psi_j\\varepsilon_{t-j}\\)è¿™æ ·çš„æ¨¡å‹æ—¶ï¼Œæ ¹æ® Bartlet å…¬å¼ï¼Œå¯å–ï¼š\n\\[t=\\frac{\\hat{\\rho}_k}{\\sqrt{\\frac{1}{T}\\left(1+2\\sum_{j=1}^{k-1}\\hat{\\rho}_j^2\\right)}},\\:k&gt;q\\]\nå½“\\(t\\)è¶…å‡º qnorm\\((1-\\alpha/2)\\)æ—¶æ‹’ç»è¿™æ ·çš„æ¨¡å‹ã€‚\n\n2.3.3.1 TODOï¼šä¾‹å­ 3.3\n\n\n\n2.3.4 Ljung-Box ç™½å™ªå£°æ£€éªŒ\nä¸ºäº†æ£€éªŒæ—¶é—´åºåˆ—æ ·æœ¬æ˜¯å¦æ¥è‡ªç™½å™ªå£°åºåˆ—ï¼Œå¯ä»¥æ£€éªŒ \\(\\rho_k = 0, k = 1, 2, \\cdots\\) çš„é›¶å‡è®¾ã€‚å‰é¢æ£€éªŒå•ä¸ª \\(\\rho_k\\) çš„åšæ³•å¦‚æœæ­£å¯¹å¤šä¸ªè¿›è¡Œæ£€éªŒå°±æœ‰å¤šé‡æ£€éªŒçš„ç¬¬ä¸€ç±»é”™è¯¯å¢å¤§çš„é—®é¢˜ã€‚\nBox å’Œ Pierce(G. Box & Pierce, 1970) æå‡ºäº†æ··æˆç»Ÿè®¡é‡ (Portmanteau statistic)ï¼š \\[Q_*(m)=T\\sum_{j=1}^m\\hat{\\rho}_j^2\\]\nç”¨æ¥æ£€éªŒï¼š\n\\[H_0:\\rho_1=\\cdots=\\rho_m=0\\longleftrightarrow H_a: \\text{ä¸å…¨ä¸ºé›¶}\\]\nåœ¨\\(\\{X_t\\}\\)æ˜¯ç‹¬ç«‹ç™½å™ªå£°åºåˆ—æ¡ä»¶ä¸‹ï¼Œ\\(Q_*(m)\\)è¿‘ä¼¼æœä»\\(\\chi^2(m)\\)åˆ†å¸ƒã€‚ç»™å®šæ£€éªŒæ°´å¹³\\(\\alpha\\),å½“\\(Q_*(m)&gt;\\)qchisq\\((1-\\alpha,m)\\) æ—¶æ‹’ç»\\(H_{0}\\),å¦å®šç™½å™ªå£°å‡è®¾ã€‚å¦‚æœæ£€éªŒçš„åºåˆ—æ˜¯çº¿æ€§æ—¶é—´åºåˆ—ä¼°è®¡çš„æ®‹å·®åºåˆ—ï¼Œåˆ™å¡æ–¹è‡ªç”±åº¦åº”æ”¹ä¸º\\(m\\)å‡å»ä¼°è®¡çš„ç³»æ•°ä¸ªæ•°ã€‚\nLjung å’Œ Box(Ljung & Box, 1978) å¯¹æ­¤æ£€éªŒæ–¹æ³•è¿›è¡Œäº†æ”¹è¿›ã€‚ç»Ÿè®¡é‡æ”¹ä¸ºï¼š\n\\[Q(m)=T(T+2)\\sum_{j=1}^m\\frac{\\hat{\\rho}_j^2}{T-j}\\]\nåœ¨ç‹¬ç«‹åŒåˆ†å¸ƒç™½å™ªå£°å‡è®¾ä¸‹ä»è¿‘ä¼¼æœä»\\(\\chi^2(m)\\)åˆ†å¸ƒã€‚å½“\\(Q( m) &gt;\\)qchisq\\(( 1- \\alpha , m)\\)æ—¶æ‹’ç»\\(H_0\\),å¦å®šç™½å™ªå£°å‡è®¾ã€‚è¿™ä¸ªæ£€éªŒç§°ä¸º Ljung-Box ç™½å™ªå£°æ£€éªŒã€‚å¦‚æœæ£€éªŒçš„åºåˆ—æ˜¯çº¿æ€§æ—¶é—´åºåˆ—ä¼°è®¡çš„æ®‹å·®åºåˆ—ï¼Œåˆ™å¡æ–¹è‡ªç”±åº¦åº”æ”¹ä¸º\\(m\\)å‡å»ä¼°è®¡çš„ç³»æ•°ä¸ªæ•°ã€‚æ¯”å¦‚ï¼Œå¯¹ ARMA\\((p,q)\\)æ¨¡å‹å»ºæ¨¡çš„æ®‹å·®ä½œç™½å™ªå£°æ£€éªŒï¼Œå¡æ–¹è‡ªç”±åº¦åº”æ”¹ä¸º\\(m-(p+q)\\)ã€‚\n\n2.3.4.1 ä¾‹å­ï¼šæ£€éªŒ IBM è‚¡ç¥¨æœˆæ”¶ç›Šç‡æ˜¯å¦ä¸ºç™½å™ªå£°\nç»˜åˆ¶æ•°æ®çš„ ACF å›¾åƒï¼š\n\n\nCode\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nraw_data = []\nwith open(\"../ftsdata/m-ibmsp-2611.txt\", \"r\", encoding=\"utf-8\") as file:\n    for line in file.readlines():\n        line = line.strip(\"\\n\").strip(\" \").replace(\"\\t\", \" \").split(\" \")\n        line = list(filter(lambda x: x != \"\", line))\n        raw_data.append(line)\ndata = pd.DataFrame(raw_data[1:], columns=raw_data[0])\n\ndata[\"date\"] = pd.to_datetime(data[\"date\"], format=\"%Y%m%d\")\ndata.set_index(\"date\", inplace=True)\ndata = data.apply(pd.to_numeric)\ndata.head()\n\nfrom statsmodels.graphics.tsaplots import plot_acf\n\nplt.figure(figsize=(8, 4))\nax = plt.gca()  # è·å–å½“å‰çš„è½´å¯¹è±¡\nplot_acf(data[\"ibm\"], ax=ax, lags=20)\nax.set_ylim(-0.25, 0.25)\nax.set_xlabel('Lag', fontsize=16)  # è®¾ç½®æ¨ªè½´æ ‡ç­¾\nplt.title('ACF of IBM Stock Monthly Returns')\nplt.show()\n\n\n\n\n\n\n\n\n\nä» ACF å›¾æ¥çœ‹ï¼Œæœˆåº¦æ”¶ç›Šç‡æ˜¯ç™½å™ªå£°ã€‚\nä½œ Ljung-Box ç™½å™ªå£°æ£€éªŒï¼Œåˆ†åˆ«å– \\(m = 12\\) å’Œ \\(m = 24\\)ï¼š\n\n\nCode\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nraw_data = []\nwith open(\"../ftsdata/m-ibmsp-2611.txt\", \"r\", encoding=\"utf-8\") as file:\n    for line in file.readlines():\n        line = line.strip(\"\\n\").strip(\" \").replace(\"\\t\", \" \").split(\" \")\n        line = list(filter(lambda x: x != \"\", line))\n        raw_data.append(line)\ndata = pd.DataFrame(raw_data[1:], columns=raw_data[0])\n\ndata[\"date\"] = pd.to_datetime(data[\"date\"], format=\"%Y%m%d\")\ndata.set_index(\"date\", inplace=True)\ndata = data.apply(pd.to_numeric)\ndata.head()\n\nfrom statsmodels.stats.diagnostic import acorr_ljungbox\n\n\n# æ‰§è¡Œ Ljung-Box ç™½å™ªå£°æ£€éªŒ\nlb_test_12 = acorr_ljungbox(data[\"ibm\"], lags=[12], return_df=True)\nprint(lb_test_12)\n\nlb_test_24 = acorr_ljungbox(data[\"ibm\"], lags=[24], return_df=True)\nprint(lb_test_24)\n\n\n      lb_stat  lb_pvalue\n12  13.097984   0.361959\n      lb_stat  lb_pvalue\n24  35.384127   0.062905\n\n\nå¯ä»¥çœ‹å‡ºï¼Œåœ¨ 0.05 æ°´å¹³ä¸‹å‡ä¸æ‹’ç»é›¶å‡è®¾ï¼Œæ”¯æŒ IBM æœˆåº¦ç®€å•æ”¶ç›Šç‡æ˜¯ç™½å™ªå£°çš„é›¶å‡è®¾ã€‚\nä»ç®€å•æ”¶ç›Šç‡è®¡ç®—å¯¹æ•°æ”¶ç›Šç‡ï¼Œå¹¶è¿›è¡Œ LB ç™½å™ªå£°æ£€éªŒï¼š\n\n\nCode\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nraw_data = []\nwith open(\"../ftsdata/m-ibmsp-2611.txt\", \"r\", encoding=\"utf-8\") as file:\n    for line in file.readlines():\n        line = line.strip(\"\\n\").strip(\" \").replace(\"\\t\", \" \").split(\" \")\n        line = list(filter(lambda x: x != \"\", line))\n        raw_data.append(line)\ndata = pd.DataFrame(raw_data[1:], columns=raw_data[0])\n\ndata[\"date\"] = pd.to_datetime(data[\"date\"], format=\"%Y%m%d\")\ndata.set_index(\"date\", inplace=True)\ndata = data.apply(pd.to_numeric)\ndata.head()\n\n# æ‰§è¡Œ Ljung-Box ç™½å™ªå£°æ£€éªŒ\nlb_test_12 = acorr_ljungbox(np.log(data[\"ibm\"] + 1), lags=[12], return_df=True)\nprint(lb_test_12)\n\nlb_test_24 = acorr_ljungbox(np.log(data[\"ibm\"] + 1), lags=[24], return_df=True)\nprint(lb_test_24)\n\n\n      lb_stat  lb_pvalue\n12  12.814366   0.382677\n      lb_stat  lb_pvalue\n24  34.505798   0.076073\n\n\nå¯ä»¥çœ‹å‡ºï¼Œåœ¨ 0.05 æ°´å¹³ä¸‹ä¸æ‹’ç»é›¶å‡è®¾ã€‚\n\n\n2.3.4.2 ä¾‹å­ï¼šæ£€éªŒ CRSP çš„ç¬¬10åˆ†ä½ç»„åˆçš„æœˆåº¦æ”¶ç›Šç‡æ˜¯å¦ä¸ºç™½å™ªå£°\nè¿™æ˜¯ [ä¾‹å­ï¼šCRSP çš„ç¬¬10åˆ†ä½ç»„åˆçš„æœˆå¯¹æ•°æ”¶ç›Šç‡] çš„ç»§ç»­ï¼Œå¯¹å…¶æ•°æ®ä½œç™½å™ªå£°æ£€éªŒã€‚\n\n\nCode\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nraw_data = []\nwith open(\"../ftsdata/m-dec12910.txt\", \"r\", encoding=\"utf-8\") as file:\n    for line in file.readlines():\n        line = line.strip(\"\\n\").strip(\" \").replace(\"\\t\", \" \").split(\" \")\n        line = list(filter(lambda x: x != \"\", line))\n        raw_data.append(line)\ndata = pd.DataFrame(raw_data[1:], columns=raw_data[0])\n\ndata[\"date\"] = pd.to_datetime(data[\"date\"], format=\"%Y%m%d\")\ndata.set_index(\"date\", inplace=True)\ndata = data.apply(pd.to_numeric)\ndata.head()\n\nfrom statsmodels.stats.diagnostic import acorr_ljungbox\n\n\n# æ‰§è¡Œ Ljung-Box ç™½å™ªå£°æ£€éªŒ\nlb_test_12 = acorr_ljungbox(data[\"dec10\"], lags=[12], return_df=True)\nprint(lb_test_12)\n\nlb_test_24 = acorr_ljungbox(data[\"dec10\"], lags=[24], return_df=True)\nprint(lb_test_24)\n\n\n      lb_stat  lb_pvalue\n12  41.059699   0.000048\n      lb_stat  lb_pvalue\n24  56.245617   0.000212\n\n\nå¯ä»¥çœ‹å‡ºï¼Œåœ¨ 0.05 æ°´å¹³ä¸‹æ‹’ç»é›¶å‡è®¾ï¼Œè®¤ä¸º CRSP ç¬¬10åˆ†ä½ç»„åˆçš„æœˆåº¦ç®€å•æ”¶ç›Šç‡ä¸æ˜¯ç™½å™ªå£°ã€‚\næœ‰æ•ˆå¸‚åœºå‡è®¾è®¤ä¸ºæ”¶ç›Šç‡æ˜¯ä¸å¯é¢„æµ‹çš„ï¼Œä¹Ÿå°±ä¸ä¼šæœ‰éé›¶çš„è‡ªç›¸å…³ã€‚ä½†æ˜¯ï¼Œè‚¡ä»·çš„å†³å®šæ–¹å¼å’ŒæŒ‡æ•°æ”¶ç›—ç‡çš„è®¡ç®—æ–¹å¼ç­‰å¯èƒ½ä¼šå¯¼è‡´åœ¨è§‚æµ‹åˆ°çš„æ”¶ç›Šç‡åºåˆ—ä¸­æœ‰è‡ªç›¸å…³æ€§ã€‚é«˜é¢‘é‡‘èæ•°æ®ä¸­å¾ˆå¸¸è§è‡ªç›¸å…³æ€§ã€‚\nå¸¸è§çš„ç™½å™ªå£°æ£€éªŒè¿˜æœ‰ TREVOR S. BREUSCH (1978) å’Œ LESLIE G. GODFREY (1978) æå‡ºçš„æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•æ£€éªŒ(LM æ£€éªŒ)ã€‚é›¶å‡è®¾ä¸ºç™½å™ªå£°ï¼Œå¯¹ç«‹å‡è®¾ä¸º ARã€MA æˆ–è€… ARMAã€‚",
    "crumbs": [
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "Ch2/2-çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹.html#çº¿æ€§æ—¶é—´åºåˆ—",
    "href": "Ch2/2-çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹.html#çº¿æ€§æ—¶é—´åºåˆ—",
    "title": "2Â  çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹",
    "section": "2.4 çº¿æ€§æ—¶é—´åºåˆ—",
    "text": "2.4 çº¿æ€§æ—¶é—´åºåˆ—\nè®¾\\(\\{X_t\\}\\)æ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒçš„äºŒé˜¶çŸ©æœ‰é™çš„éšæœºå˜é‡ï¼Œç§°\\(\\{X_t\\}\\)ä¸ºç‹¬ç«‹åŒåˆ†å¸ƒç™½å™ªå£° (white noise)ã€‚æœ€å¸¸ç”¨çš„ç™½å™ªå£°ä¸€èˆ¬å‡è®¾å‡å€¼ä¸ºé›¶ã€‚å¦‚æœ\\(\\{X_t\\}\\)ç‹¬ç«‹åŒ N\\((0,\\sigma^2)\\)åˆ†å¸ƒï¼Œç§°\\(\\{X_t\\}\\)ä¸ºé«˜æ–¯(Gaussian) ç™½å™ªå£°æˆ–æ­£æ€ç™½å™ªå£°ã€‚\nç™½å™ªå£°åºåˆ—çš„è‡ªç›¸å…³å‡½æ•°ä¸ºé›¶(\\(\\rho_0=1\\)é™¤å¤–)ã€‚\nå®é™…åº”ç”¨ä¸­å¦‚æœæ ·æœ¬è‡ªç›¸å…³å‡½æ•°è¿‘ä¼¼ä¸ºé›¶(ACF å›¾ä¸­éƒ½ä½äºæ§åˆ¶çº¿ä¹‹å†…æˆ–åŸºæœ¬ä¸è¶…å‡ºæ§åˆ¶çº¿),åˆ™å¯è®¤ä¸ºè¯¥åºåˆ—æ˜¯ç™½ å™ªå£°çš„æ ·æœ¬ã€‚\nè®¾\\(\\{\\varepsilon_t\\}\\)æ˜¯é›¶å‡å€¼ç‹¬ç«‹åŒåˆ†å¸ƒç™½å™ªå£°ï¼Œ\\(\\operatorname{Var}(\\varepsilon_t)=\\sigma^2\\),æ•°åˆ—\\(\\{\\psi_j\\}\\)æ»¡è¶³\\(\\sum_j\\psi_j^2&lt;\\infty,\\psi_0=1\\),ä»¤ï¼š\n\\[X_t=\\mu+\\sum_{j=0}^\\infty\\psi_j\\varepsilon_{t-j},t\\in\\mathbb{Z}\\]\nåˆ™ç§°\\(\\left\\{X_t\\right\\}\\)æ˜¯(å› æœ)çº¿æ€§æ—¶é—´åºåˆ—ï¼Œ\\(\\varepsilon_t\\)ä»£è¡¨äº†åœ¨æ—¶åˆ»\\(t\\)å¢åŠ çš„å˜åŠ¨ä¿¡æ¯ï¼Œç§°ä¸ºæ–°æ¯(innovation)æˆ–è€…æ‰°åŠ¨ (shock)ã€‚å› æœçº¿æ€§æ—¶é—´åºåˆ—æ»¡è¶³æ–°æ¯\\(\\varepsilon_{t+j}(j\\geq1)\\)ä¸å†å²çš„\\(X_t,X_{t-1}\\)ç‹¬ç«‹ã€‚è€Œä¸”ï¼Œ\\(\\{X_t-1,X_{t-2},...\\}\\)ä¸\\(\\{\\varepsilon_t-1,\\varepsilon_{t-2},...\\}\\)å¯ä»¥äº’ç›¸çº¿æ€§åœ°è¡¨ç¤ºã€‚\nè¿™ä¸ªå®šä¹‰å¯ä»¥æ”¾å®½åˆ°\\(\\left\\{\\varepsilon_t\\right\\}\\)æ˜¯å®½å¹³ç¨³çš„ä¸ç›¸å…³åˆ—(å®½ç™½å™ªå£°)çš„æƒ…å½¢ã€‚è¿™æ—¶ï¼Œç§°(3.1)ä¸º\\(\\left\\{X_t\\right\\}\\)çš„ Wold åˆ†è§£ï¼Œç§°\\(\\left\\{X_t\\right\\}\\) ä¸ºçº¯éå†³å®šæ€§åºåˆ—ã€‚\nè®¸å¤šå¼±å¹³ç¨³æ—¶é—´åºåˆ—æ˜¯çº¿æ€§æ—¶é—´åºåˆ—ï¼Œåé¢è®²åˆ°çš„ AR æ¨¡å‹ã€MA æ¨¡å‹ã€ARMA æ¨¡å‹éƒ½å±äºçº¿æ€§æ—¶é—´åºåˆ—ã€‚å¦å¤–çš„ è®¸å¤šå¼±å¹³ç¨³æ—¶é—´åºåˆ—å¯ä»¥è¢«çº¿æ€§æ—¶é—´åºåˆ—è¿‘ä¼¼ã€‚éå¹³ç¨³çš„æ—¶é—´åºåˆ—ä¸æ˜¯çº¿æ€§æ—¶é—´åºåˆ—ã€‚\n\\(\\{\\psi_j\\}\\)ç§°ä¸ºæ¨¡å‹çš„\\(\\psi\\)æƒé‡ã€‚æ˜“è§ï¼š\n\\[EX_t=\\mu,\\quad\\mathrm{Var}(X_t)=\\sigma^2\\sum_{j=0}^\\infty\\psi_j^2,\\]\nè‡ªåæ–¹å·®å‡½æ•°ä¸ºï¼š\n\\[\\begin{aligned}\\gamma_{k}=&\\mathrm{Cov}(X_{t},X_{t-k})=E\\left[\\left(\\sum_{i=0}^{\\infty}\\psi_{i}\\varepsilon_{t-i}\\right)\\left(\\sum_{i=0}^{\\infty}\\psi_{i}\\varepsilon_{t-i-l}\\right)\\right]\\\\=&E\\left(\\sum_{i,j=0}^{\\infty}\\psi_{i}\\psi_{j}\\varepsilon_{t-i}\\varepsilon_{t-j-k}\\right)=\\sigma^{2}\\sum_{i,j=0}^{\\infty}\\psi_{i}\\psi_{j}\\delta_{i-j-k}\\\\=&\\sigma^{2}\\sum_{j=0}^{\\infty}\\psi_{j}\\psi_{j+k}\\end{aligned}\\]\nå…¶ä¸­\\(\\delta_k\\)å½“\\(k=0\\)æ—¶ä¸º 1,å½“\\(k\\neq0\\)æ—¶ä¸º0ã€‚\nè‡ªç›¸å…³å‡½æ•°ä¸ºï¼š\n\\[\\rho_k=\\dfrac{\\gamma_k}{\\gamma_0}=\\dfrac{\\sum_{j=0}^\\infty\\psi_j\\psi_{j+k}}{1+\\sum_{j=1}^\\infty\\psi_j^2},\\:k\\ge0\\]\nçº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹æ»¡è¶³\\(\\psi_j\\to0,j\\to\\infty\\),æ‰€ä»¥å†å²ä¸Šçš„æ‰°åŠ¨çš„å½±å“ä¼šé€æ¸æ¶ˆå¤±ã€‚å¦å¤–\\(\\rho_k\\to0,k\\to\\infty\\),æ‰€ä»¥ç›¸è·è¾ƒè¿œçš„è§‚æµ‹ä¹‹é—´çš„ç›¸å…³æ€§å¾ˆå°ã€‚\nä¸æ˜¯æ‰€æœ‰çš„å¼±å¹³ç¨³æ—¶é—´åºåˆ—éƒ½æœ‰è¿™æ ·çš„æ€§è´¨ã€‚éå¹³ç¨³åºåˆ—æ›´æ˜¯ä¸éœ€è¦æ»¡è¶³è¿™äº›æ€§è´¨ã€‚",
    "crumbs": [
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "Ch2/2-çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹.html#é™„å½•è¡¥å……çŸ¥è¯†",
    "href": "Ch2/2-çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹.html#é™„å½•è¡¥å……çŸ¥è¯†",
    "title": "2Â  çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹",
    "section": "2.5 é™„å½•ï¼šè¡¥å……çŸ¥è¯†",
    "text": "2.5 é™„å½•ï¼šè¡¥å……çŸ¥è¯†",
    "crumbs": [
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>çº¿æ€§æ—¶é—´åºåˆ—æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "Ch3/3-è‡ªå›å½’æ¨¡å‹.html",
    "href": "Ch3/3-è‡ªå›å½’æ¨¡å‹.html",
    "title": "3Â  è‡ªå›å½’æ¨¡å‹",
    "section": "",
    "text": "3.1 è‡ªå›å½’æ¨¡å‹çš„æ¦‚å¿µ\nå¦‚æœ\\(\\rho_1\\neq0\\),åˆ™\\(X_t\\)ä¸\\(X_{t-1}\\)ç›¸å…³ï¼Œå¯ä»¥ç”¨\\(X_{t-1}\\)é¢„æµ‹\\(X_t\\)ã€‚æœ€ç®€å•çš„é¢„æµ‹ä¸ºçº¿æ€§ç»„åˆï¼Œå¦‚ä¸‹æ¨¡å‹ï¼š\n\\[X_t=\\phi_0+\\phi_1X_{t-1}+\\varepsilon_t\\]\nç§°ä¸ºä¸€é˜¶è‡ªå›å½’æ¨¡å‹ (Autoregression model),è®°ä½œ AR(1)æ¨¡å‹ã€‚å…¶ä¸­\\(\\{\\varepsilon_t\\}\\)æ˜¯é›¶å‡å€¼ç‹¬ç«‹åŒåˆ†å¸ƒç™½å™ªå£°åºåˆ—ï¼Œæ–¹å·®ä¸º\\(\\sigma^2\\),å¹¶è®¾\\(\\varepsilon_t\\)ä¸\\(X_{t-1},X_{t-2},...\\)ç‹¬ç«‹ã€‚ç³»æ•°\\(|\\phi_1|&lt;1\\)ã€‚æ›´ä¸€èˆ¬çš„å®šä¹‰ä¸­ä»…è¦æ±‚\\(\\{\\varepsilon_t\\}\\)æ˜¯é›¶å‡å€¼ç™½å™ªå£°ï¼Œä¸è¦æ±‚ç‹¬ç«‹åŒåˆ†å¸ƒã€‚\nè¿™ä¸ªæ¨¡å‹ä¸ä¸€å…ƒçº¿æ€§å›å½’æ¨¡å‹\\(Y_i=\\phi_0+\\phi_1x_i+\\varepsilon_i\\)åœ¨æŸäº›æ–¹é¢ç±»ä¼¼ï¼Œæ¯”å¦‚ï¼Œ\\(\\varepsilon_t\\)éƒ½æ˜¯èµ·åˆ°è¯¯å·®æˆ–è€…æ‰°åŠ¨çš„ä½œç”¨ã€‚ä½†æ˜¯ï¼Œ åœ¨è‡ªå›å½’æ¨¡å‹ä¸­ï¼Œè‡ªå˜é‡\\(X_{t-1}\\)åœ¨æ—¶åˆ»\\(t-1\\)æ—¶ä½œä¸ºå› å˜é‡ï¼Œæ‰€ä»¥è‡ªå›å½’æ¨¡å‹ä¸­å› å˜é‡å’Œè‡ªå˜é‡ä¸æ˜¯ä¸¤ä¸ªå˜é‡è€Œæ˜¯åŒä¸€ä¸ªå˜é‡çš„ä¸åŒæ—¶åˆ»ã€‚å›å½’æ¨¡å‹çš„ç†è®ºç»“æœä¸èƒ½ç›´æ¥åº”ç”¨åˆ°è‡ªå›å½’æ¨¡å‹å½“ä¸­ã€‚\nAR(1)æ¨¡å‹ä¹Ÿæ˜¯é©¬å°”å¯å¤« (Markov) è¿‡ç¨‹ï¼š\\(X_t\\)åœ¨\\(X_{t-1},X_{t-2},...\\)æ¡ä»¶ä¸‹çš„æ¡ä»¶åˆ†å¸ƒï¼Œåªä¸\\(X_{t-1}\\)æœ‰å…³ã€‚å·²çŸ¥\\(X_{t-1}\\)åï¼Œç”¨\\(X_{t-1},X_{t-2},...\\)å»é¢„æµ‹\\(X_t\\),ä¸ä»…ç”¨\\(X_{t-1}\\)å»é¢„æµ‹çš„æ•ˆæœç›¸åŒã€‚è¿™ç§æ€§è´¨ç§°ä¸ºé©¬æ°æ€§ã€‚\næ¡ä»¶æœŸæœ›å’Œæ¡ä»¶æ–¹å·®ï¼š\n\\[E(X_t|X_{t-1})=\\phi_0+\\phi_1X_{t-1},\\quad\\mathrm{Var}(X_t|X_{t-1})=\\sigma^2\\]\nå³åœ¨\\(X_t-1=x_{t-1}\\)å·²çŸ¥åï¼Œ\\(X_t\\)æ¡ä»¶çš„æ¡ä»¶åˆ†å¸ƒæ˜¯æœŸæœ›ä¸º\\(\\phi_0+\\phi_1x_{t-1}\\),æ–¹å·®ä¸º\\(\\sigma^2\\)çš„åˆ†å¸ƒã€‚å¯ä»¥è¯æ˜ï¼š\n\\[\\mathrm{Var}(X_t)=\\frac{\\sigma^2}{1-\\phi_1^2}\\]\nå› ä¸º\\(|\\phi_1|&lt;1\\),æ‰€ä»¥\\(X_t\\)åœ¨\\(X_t-1=x_{t-1}\\)å·²çŸ¥æ¡ä»¶ä¸‹çš„æ¡ä»¶æ–¹å·®å°äºå…¶æ— æ¡ä»¶æ–¹å·®ï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨\\(X_t-1\\)çš„ä¿¡æ¯å»é¢„æµ‹\\(X_t\\),å¯ä»¥ä½¿å¾—\\(X_t\\)çš„æ³¢åŠ¨å‡å°ï¼Œèƒ½å¤Ÿè¾¾åˆ°é¢„æµ‹çš„æ•ˆæœã€‚\nAR(1)æ¨¡å‹çš„æ¨å¹¿æ˜¯ AR\\((p)\\)æ¨¡å‹ï¼š\n\\[X_t=\\phi_0+\\phi_1X_{t-1}+\\cdots+\\phi_pX_{t-p}+\\varepsilon_t\\]\nå…¶ä¸­\\(\\{\\varepsilon_t\\}\\)æ˜¯é›¶å‡å€¼ç‹¬ç«‹åŒåˆ†å¸ƒç™½å™ªå£°åºåˆ—ï¼Œæ–¹å·®ä¸º\\(\\sigma^2\\),ä¸”\\(\\varepsilon_t\\)ä¸\\(X_t-1,X_{t-2},...\\)ç‹¬ç«‹ã€‚ç³»æ•°\\(\\phi_1,...,\\phi_p\\)éœ€è¦æ»¡è¶³å¦‚ä¸‹æ¡ä»¶ï¼šæ–¹ç¨‹\n\\[1-\\phi_1z-\\cdots-\\phi_pz^p=0\\]\nçš„æ‰€æœ‰å¤æ ¹\\(z_*\\)éƒ½æ»¡è¶³\\(|z_*|&gt;1\\),ä¸Šè¿°æ–¹ç¨‹çš„å·¦è¾¹çš„å¤šé¡¹å¼ç§°ä¸º AR(p) æ¨¡å‹çš„ç‰¹å¾å¤šé¡¹å¼ï¼Œç‰¹å¾å¤šé¡¹å¼çš„æ‰€æœ‰å¤æ ¹ç§°ä¸ºç‰¹å¾æ ¹ï¼Œå¯¹ç³»æ•°çš„æ¡ä»¶ç§°ä¸ºâ€œç‰¹å¾æ ¹éƒ½åœ¨å•ä½åœ†å¤–â€ã€‚åœ¨æœ‰çš„æ•™æä¸­å°†ç‰¹å¾å¤šé¡¹å¼çš„æ ¹çš„å€’æ•°å®šä¹‰ä¸ºç‰¹å¾æ ¹ï¼Œåœ¨(R. S. Tsay, 2013) ä¸­å°±æ˜¯ä»¥å€’æ•°ä¸ºç‰¹å¾æ ¹ã€‚å¯¹ AR(1) å°±æ˜¯è¦æ±‚\\(|\\phi_1|&lt;1.\\)\næ›´ä¸€èˆ¬çš„å®šä¹‰ä¸­ä»…è¦æ±‚\\(\\{\\varepsilon_t\\}\\)æ˜¯é›¶å‡å€¼ç™½å™ªå£°ï¼Œä¸è¦æ±‚ç‹¬ç«‹åŒåˆ†å¸ƒã€‚",
    "crumbs": [
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>è‡ªå›å½’æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "Ch3/3-è‡ªå›å½’æ¨¡å‹.html#æ»åç®—å­",
    "href": "Ch3/3-è‡ªå›å½’æ¨¡å‹.html#æ»åç®—å­",
    "title": "3Â  è‡ªå›å½’æ¨¡å‹",
    "section": "3.2 æ»åç®—å­",
    "text": "3.2 æ»åç®—å­\nè®¾\\(\\{\\xi_t,t\\in\\mathbb{Z}\\}\\)ä¸ºå¼±å¹³ç¨³æ—¶é—´åºåˆ—æˆ–è€…å¸¸æ•°åˆ—ï¼Œå®šä¹‰å¦‚ä¸‹çš„æ»åç®—å­\\(B\\)ï¼š\n\\[B\\xi_t=\\xi_{t-1},\\quad B^j\\xi_t=\\xi_{t-j},\\:j\\in\\mathbb{Z}\\]\nè€ƒè™‘å¤å˜å‡½æ•°\\(P(z)=\\sum_{j=0}^\\infty a_jz^j\\),å…¶ä¸­\\(\\{a_j\\}\\)ä¸ºå®æ•°åˆ—ï¼Œè®¾\\(\\sum_{j=0}^\\infty|a_j|&lt;\\infty\\) (ç§°ä¸ºç³»æ•°ç»å¯¹å¯å’Œ),æœ‰é™é˜¶å¤šé¡¹å¼ä¸º\\(P(z)\\)çš„ç‰¹ä¾‹ã€‚å®šä¹‰ï¼š\n\\[P(B)\\xi_t=\\sum_{j=0}^\\infty a_j\\xi_{j-t}.\\]\n\\(P(B)\\)ä¹Ÿç§°ä¸ºä¸€ä¸ª(å¸¸ç³»æ•°æ—¶é½)çº¿æ€§æ»¤æ³¢å™¨ï¼Œ\\(P(B)\\xi_t\\)æ˜¯\\(\\{\\xi_t\\}\\)åºåˆ—çš„ä¸€ä¸ªæ»‘åŠ¨å¹³å‡å˜æ¢ã€‚\nè®¾\\(Q(z)=\\sum_{j=0}^\\infty b_jz^j,\\{b_j\\}\\)ä¸ºå®æ•°åˆ—ï¼Œç»å¯¹å¯å’Œï¼Œåˆ™\\(C(z)=P(z)Q(z)=\\sum_{j=0}^\\infty c_jz^j\\),å…¶ä¸­ï¼š\n\\[c_j=\\sum\\limits_{i=0}^ja_ib_{j-i},\\:j=0,1,...\\]\nä¸”\\(\\{c_j\\}\\)ç»å¯¹å¯å’Œï¼Œç§°æ•°åˆ—\\(\\{c_j\\}\\)æ˜¯æ•°åˆ—\\(\\{a_j\\}\\)å’Œæ•°åˆ—\\(\\{b_j\\}\\)çš„ç¦»æ•£å·ç§¯ã€‚å¯¹ä»»æ„å¼±å¹³ç¨³åˆ—æˆ–è€…å¸¸æ•°åˆ—\\(\\{\\xi_t\\}\\)å‡æœ‰ï¼š\n\\[P(B)Q(B)\\xi_t=Q(B)P(B)\\xi_t=C(B)\\xi_t,\\:t\\in\\mathbb{Z}\\]\nè‹¥\\(\\xi_t\\equiv\\xi\\)ä¸\\(t\\)æ— å…³ï¼Œåˆ™\\(B^j\\xi=\\xi\\)ã€‚æ¯”å¦‚ï¼Œ\\(B^j1=1,P(B)1=P(1)\\)ã€‚\nä»¤\\(D(z)=\\frac{P(z)}{Q(z)}\\),è‹¥\\(Q(z)\\neq0\\)å¯¹ä»»æ„æ»¡è¶³\\(|z|\\leq1\\)çš„å¤æ•°\\(z\\)å‡æˆç«‹ï¼Œåˆ™\\(D(z)=\\sum_{j=0}^\\infty d_jz^j,\\{d_j\\}\\)ç»å¯¹å¯å’Œï¼Œä¸”ï¼š\n\\[P(B)\\xi_t=Q(B)D(B)\\xi_t=D(B)Q(B)\\xi_t,\\:t\\in\\mathbb{Z}\\]",
    "crumbs": [
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>è‡ªå›å½’æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "Ch3/3-è‡ªå›å½’æ¨¡å‹.html#todo-ar1-æ¨¡å‹çš„æ€§è´¨",
    "href": "Ch3/3-è‡ªå›å½’æ¨¡å‹.html#todo-ar1-æ¨¡å‹çš„æ€§è´¨",
    "title": "3Â  è‡ªå›å½’æ¨¡å‹",
    "section": "3.3 TODO: AR(1) æ¨¡å‹çš„æ€§è´¨",
    "text": "3.3 TODO: AR(1) æ¨¡å‹çš„æ€§è´¨",
    "crumbs": [
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>è‡ªå›å½’æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "Ch3/3-è‡ªå›å½’æ¨¡å‹.html#todo-ar1-æ¨¡å‹çš„è‡ªç›¸å…³å‡½æ•°",
    "href": "Ch3/3-è‡ªå›å½’æ¨¡å‹.html#todo-ar1-æ¨¡å‹çš„è‡ªç›¸å…³å‡½æ•°",
    "title": "3Â  è‡ªå›å½’æ¨¡å‹",
    "section": "3.4 TODO: AR(1) æ¨¡å‹çš„è‡ªç›¸å…³å‡½æ•°",
    "text": "3.4 TODO: AR(1) æ¨¡å‹çš„è‡ªç›¸å…³å‡½æ•°",
    "crumbs": [
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>è‡ªå›å½’æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "Ch3/3-è‡ªå›å½’æ¨¡å‹.html#todo-ar2-æ¨¡å‹çš„æ€§è´¨",
    "href": "Ch3/3-è‡ªå›å½’æ¨¡å‹.html#todo-ar2-æ¨¡å‹çš„æ€§è´¨",
    "title": "3Â  è‡ªå›å½’æ¨¡å‹",
    "section": "3.5 TODO: AR(2) æ¨¡å‹çš„æ€§è´¨",
    "text": "3.5 TODO: AR(2) æ¨¡å‹çš„æ€§è´¨\n\n3.5.0.1 TODO: ä¾‹å­ï¼šç¾å›½çš„å›½æ°‘ç”Ÿäº§æ€»å€¼ (GNP) ç»è¿‡å­£èŠ‚è°ƒæ•´åçš„å­£åº¦å¢é•¿ç‡",
    "crumbs": [
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>è‡ªå›å½’æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "Ch3/3-è‡ªå›å½’æ¨¡å‹.html#arp-æ¨¡å‹çš„æ€§è´¨",
    "href": "Ch3/3-è‡ªå›å½’æ¨¡å‹.html#arp-æ¨¡å‹çš„æ€§è´¨",
    "title": "3Â  è‡ªå›å½’æ¨¡å‹",
    "section": "3.6 AR(p) æ¨¡å‹çš„æ€§è´¨",
    "text": "3.6 AR(p) æ¨¡å‹çš„æ€§è´¨\nå¯¹äºä¸€èˆ¬çš„AR( p) æ¨¡å‹ï¼Œå…¶ ACF çš„æ€§è´¨ä»¥åŠåºåˆ—çš„éšæœºå‘¨æœŸï¼Œä¹Ÿç”±å…¶ç‰¹å¾æ ¹å†³å®šã€‚ACF å¯ä»¥æ˜¯å•è°ƒè¡°å‡ã€éœ‡è¡è¡°å‡ã€æ­£è´Ÿäº¤æ›¿è¡°å‡ã€å‘ˆå‘¨æœŸéœ‡è¡è¡°å‡ã€‚åœ¨æœ‰å¤ç‰¹å¾æ ¹æ ¹æˆ–è€…æœ‰æ¥è¿‘-1çš„ç‰¹å¾æ ¹æ—¶æ—¶é—´åºåˆ—å‘ˆç°å‡ºä¸€å®šçš„éšæœºå‘¨æœŸå˜åŒ–ã€‚\nç”±å¹³ç¨³æ€§å¾—ï¼š\n\\[\\mu=\\frac{\\phi_0}{1-\\phi_1-\\cdots-\\phi_p}\\]\nè‡ªç›¸å…³å‡½æ•° (ACF) æ»¡è¶³å¦‚ä¸‹çš„é€’æ¨(å·®åˆ†æ–¹ç¨‹)ï¼š\n\\[\\begin{matrix}(1-\\phi_1B-\\cdots-\\phi_pB^p)\\rho_j=0,&j=1,2,...\\end{matrix}\\]\nAR\\((p)\\)æ¨¡å‹çš„å¹³ç¨³è§£æ˜¯çº¿æ€§æ—¶é—´åºåˆ—ã€‚",
    "crumbs": [
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>è‡ªå›å½’æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "Ch3/3-è‡ªå›å½’æ¨¡å‹.html#åè‡ªç›¸å…³å‡½æ•°",
    "href": "Ch3/3-è‡ªå›å½’æ¨¡å‹.html#åè‡ªç›¸å…³å‡½æ•°",
    "title": "3Â  è‡ªå›å½’æ¨¡å‹",
    "section": "3.7 åè‡ªç›¸å…³å‡½æ•°",
    "text": "3.7 åè‡ªç›¸å…³å‡½æ•°\nå®é™…æ•°æ®ç”¨ AR æ¨¡å‹å»ºæ¨¡æ—¶ï¼Œé˜¶æ•°\\(p\\)æ˜¯æœªçŸ¥çš„ï¼Œç¡®å®š\\(p\\)çš„é—®é¢˜ç§°ä¸ºå®šé˜¶ã€‚ä¸€èˆ¬å¸¸ç”¨åè‡ªç›¸å…³å‡½æ•°å’Œ AIC å‡†åˆ™ã€‚\nè®¾\\(X_1,...,X_n,Y\\)ä¸ºéšæœºå˜é‡ï¼š\n\\[L(Y|X_1,\\dots,X_n)=\\underset{\\hat{Y}=b_0+b_1X_1+\\dots+b_nX_n}{\\operatorname*{argmin}}E(Y-\\hat{Y})^2\\]\nç§°ä¸ºç”¨\\(X_1,...,X_n\\)å¯¹\\(Y\\)çš„æœ€ä¼˜çº¿æ€§é¢„æµ‹ã€‚\\(Y-L(Y|X_1,...,X_n)\\)ä¸\\(Z-L(Z|X_1,...,X_n)\\)çš„ç›¸å…³ç³»æ•°ç§°ä¸º\\(Y\\)å’Œ\\(Z\\) åœ¨æ‰£é™¤\\(X_1,...,X_n\\)å½±å“åçš„åç›¸å…³ç³»æ•°ã€‚\nå¯¹å¹³ç¨³çº¿æ€§æ—¶é—´åºåˆ—ï¼Œå¯¹\\(n=1,2,...\\),æœ‰ï¼š\n\\[L(X_t|X_{t-1},...,X_{t-n})=\\phi_{n0}+\\phi_{n1}X_{t-1}+...+\\phi_{nn}X_{t-n}\\]\nå…¶ä¸­\\(\\phi_{nj},j=0,1,...,n\\)ä¸\\(t\\)æ— å…³ã€‚ç§°\\(\\phi_{nn}\\)ä¸ºæ—¶é—´åºåˆ—\\(\\{X_t\\}\\)çš„åè‡ªç›¸å…³ç³»æ•°ï¼Œ\\(\\{\\phi_{nn}\\}\\)åºåˆ—ç§°ä¸ºæ—¶é—´åºåˆ—\\(\\{X_t\\}\\)çš„åè‡ªç›¸å…³å‡½æ•°(PACF)ã€‚\n\\(\\phi_{nn}\\)å®é™…æ˜¯\\(X_t\\)ä¸\\(X_t-n\\)åœ¨æ‰£é™¤\\(X_t-2,...,X_t-n+1\\)çš„å½±å“åçš„åç›¸å…³ç³»æ•°ã€‚\\(\\phi_11\\)å°±æ˜¯\\(\\rho_1\\)ã€‚\n\\(\\phi_{nn}\\)ç”¨æ ·æœ¬è¿›è¡Œä¼°è®¡ï¼Œå¾—åˆ°çš„ä¼°è®¡å€¼\\(\\hat{\\phi}_{nn},n=1,2,...\\)ç§°ä¸ºæ ·æœ¬åè‡ªç›¸å…³å‡½æ•°ã€‚\nå¦‚æœ\\(\\{X_t\\}\\)æœä»å¦‚ä¸‹ AR\\((p)\\)æ¨¡å‹ï¼š\n\\[X_t=\\phi_0+\\phi_1X_{t-1}+\\cdots+\\phi_pX_{t-p}+\\varepsilon_t,\\:\\phi_p\\neq0\\]\nè¿™æ„å‘³ç€ç”¨\\(X_{t-1},X_{t-2},...\\)çš„çº¿æ€§ç»„åˆé¢„æµ‹\\(X_t\\)æ—¶ï¼Œåªéœ€è¦ç”¨åˆ°\\(X_t-1,...,X_{t-p}\\),å¢åŠ \\(X_{t-p-1},X_{t-p-2},...\\)ä¸èƒ½æ”¹è¿›é¢„æµ‹ã€‚è¿™æ„å‘³ç€\\(\\phi_{kk}=0,k&gt;p\\)ã€‚è¿™ç§æ€§è´¨å«åš AR æ¨¡å‹çš„åè‡ªç›¸å…³å‡½æ•°æˆªå°¾æ€§ã€‚\nAR(p) åºåˆ—çš„æ ·æœ¬åè‡ªç›¸å…³å‡½æ•°\\(\\hat{\\phi}_{kk}\\)æ»¡è¶³å¦‚ä¸‹æ€§è´¨ï¼š\n\n\\(T\\to \\infty\\) æ—¶\\(\\hat{\\phi}_pp\\to\\phi_p\\neq0\\)ã€‚\nå¯¹\\(k&gt;p,\\hat{\\phi}_{kk}\\to0(\\hat{T}\\to\\infty)\\)ã€‚\nå¯¹\\(k&gt;p,\\hat{\\phi}_{kk}\\)æ¸è¿‘æ–¹å·®ä¸º\\(\\frac1T\\)ã€‚\n\nè¿™æ ·ï¼Œå¯ä»¥ç”¨ç±»ä¼¼å¯¹ ACF çš„ç™½å™ªå£°æ£€éªŒé‚£æ ·ç»™ PACF å›¾ç”»å‡º\\(\\pm\\frac2{\\sqrt{T}}\\)çš„ä¸Šä¸‹ç•Œé™ï¼Œä»¥æ­¤åˆ¤æ–­ PACF åœ¨å“ªé‡Œæˆªå°¾ã€‚\n\n3.7.0.1 ä¾‹å­ï¼šCRSP ä»·å€¼åŠ æƒæŒ‡æ•°æœˆåº¦æ”¶ç›Šç‡\næŸ¥çœ‹æ•°æ®ï¼š\n\n\nCode\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nraw_data = []\nwith open(\"../ftsdata/m-ibm3dx2608.txt\", \"r\", encoding=\"utf-8\") as file:\n    for line in file.readlines():\n        line = line.strip(\"\\n\").strip(\" \").replace(\"\\t\", \" \").split(\" \")\n        line = list(filter(lambda x: x != \"\", line))\n        raw_data.append(line)\ndata = pd.DataFrame(raw_data[1:], columns=raw_data[0])\n\ndata[\"date\"] = pd.to_datetime(data[\"date\"], format=\"%Y%m%d\")\ndata.set_index(\"date\", inplace=True)\ndata = data.apply(pd.to_numeric)\ndata.head()\n\nplt.figure(figsize=(8, 4))\nplt.plot(data[\"vwrtn\"], label='Value Weighted Return', color=\"green\")\nplt.title('CRSP Value Weighted Index Monthly Return')\nplt.ylabel('Value Weighted')\nplt.legend()\nplt.show()\n\n\n\n\n\n\n\n\n\nç»˜åˆ¶ ACF å›¾åƒï¼š\n\n\nCode\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nraw_data = []\nwith open(\"../ftsdata/m-ibm3dx2608.txt\", \"r\", encoding=\"utf-8\") as file:\n    for line in file.readlines():\n        line = line.strip(\"\\n\").strip(\" \").replace(\"\\t\", \" \").split(\" \")\n        line = list(filter(lambda x: x != \"\", line))\n        raw_data.append(line)\ndata = pd.DataFrame(raw_data[1:], columns=raw_data[0])\n\ndata[\"date\"] = pd.to_datetime(data[\"date\"], format=\"%Y%m%d\")\ndata.set_index(\"date\", inplace=True)\ndata = data.apply(pd.to_numeric)\ndata.head()\n\nfrom statsmodels.graphics.tsaplots import plot_acf\n\nplt.figure(figsize=(8, 4))\nax = plt.gca()  # è·å–å½“å‰çš„è½´å¯¹è±¡\nplot_acf(data[\"vwrtn\"], ax=ax, lags=30)\nax.set_ylim(-0.25, 0.25)\nax.set_xlabel('Lag', fontsize=16)  # è®¾ç½®æ¨ªè½´æ ‡ç­¾\nplt.title('ACF of Value Weighted Return')\nplt.show()\n\n\n\n\n\n\n\n\n\nå‘ç° ACF åˆ° \\(k = 21\\) è¿˜æ²¡æœ‰æˆªå°¾ï¼Œç»˜åˆ¶ PACF å›¾ï¼š\n\n\nCode\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nraw_data = []\nwith open(\"../ftsdata/m-ibm3dx2608.txt\", \"r\", encoding=\"utf-8\") as file:\n    for line in file.readlines():\n        line = line.strip(\"\\n\").strip(\" \").replace(\"\\t\", \" \").split(\" \")\n        line = list(filter(lambda x: x != \"\", line))\n        raw_data.append(line)\ndata = pd.DataFrame(raw_data[1:], columns=raw_data[0])\n\ndata[\"date\"] = pd.to_datetime(data[\"date\"], format=\"%Y%m%d\")\ndata.set_index(\"date\", inplace=True)\ndata = data.apply(pd.to_numeric)\ndata.head()\n\nfrom statsmodels.graphics.tsaplots import plot_pacf\n\nplt.figure(figsize=(8, 4))\nax = plt.gca()  # è·å–å½“å‰çš„è½´å¯¹è±¡\nplot_pacf(data[\"vwrtn\"], ax=ax, lags=30)\nax.set_ylim(-0.25, 0.25)\nax.set_xlabel('Lag', fontsize=16)  # è®¾ç½®æ¨ªè½´æ ‡ç­¾\nplt.title('PACF of Value Weighted Return')\nplt.show()\n\n\n\n\n\n\n\n\n\næŸ¥çœ‹ PACF å›¾åƒï¼Œå¯ä»¥è¿‘ä¼¼è®¤ä¸º \\(p = 3\\)ï¼Œä½†å®é™…ä¸Š PACF åœ¨ \\(k = 17\\) å¤„ä»æœªæˆªå°¾ã€‚\n\n\n3.7.0.2 ä¾‹å­ï¼šç¾å›½çš„å›½æ°‘ç”Ÿäº§æ€»å€¼ (GNP) ç»è¿‡å­£èŠ‚è°ƒæ•´åçš„å­£åº¦å¢é•¿ç‡\nè¿™æ˜¯ TODO: ä¾‹å­ï¼šç¾å›½çš„å›½æ°‘ç”Ÿäº§æ€»å€¼ (GNP) ç»è¿‡å­£èŠ‚è°ƒæ•´åçš„å­£åº¦å¢é•¿ç‡ çš„ç»§ç»­ï¼Œåˆ¤æ–­ç¾å›½ GNP ç»è¿‡å­£èŠ‚è°ƒæ•´åçš„å­£åº¦å¢é•¿ç‡çš„ \\(p\\) çš„å–å€¼ã€‚\nç»˜åˆ¶ ACF å›¾ï¼š\n\n\nCode\nimport pandas as pd\n\n# è¯»å–æ•°æ®æ–‡ä»¶\nda = pd.read_csv(\"../ftsdata/q-gnp4710.txt\", sep='\\s+', dtype=float)\ndata = pd.DataFrame(da[\"VALUE\"].values, index=pd.date_range(start=\"1947-01\", periods=len(da), freq='QE'), columns=[\"value\"])\ndata.head()\n\nfrom statsmodels.graphics.tsaplots import plot_acf\n\nplt.figure(figsize=(8, 4))\nax = plt.gca()  # è·å–å½“å‰çš„è½´å¯¹è±¡\nplot_acf(np.diff(np.log(data[\"value\"])), ax=ax, lags=30)\nax.set_ylim(-0.25, 1)\nax.set_xlabel('Lag', fontsize=16)  # è®¾ç½®æ¨ªè½´æ ‡ç­¾\nplt.title('')\nplt.show()\n\n\n\n\n\n\n\n\n\nACF å›¾æ˜æ˜¾ä¸æˆªå°¾ï¼Œç»˜åˆ¶ PACF å›¾ï¼š\n\n\nCode\nimport pandas as pd\n\n# è¯»å–æ•°æ®æ–‡ä»¶\nda = pd.read_csv(\"../ftsdata/q-gnp4710.txt\", sep='\\s+', dtype=float)\ndata = pd.DataFrame(da[\"VALUE\"].values, index=pd.date_range(start=\"1947-01\", periods=len(da), freq='QE'), columns=[\"value\"])\ndata.head()\n\nfrom statsmodels.graphics.tsaplots import plot_pacf\n\nplt.figure(figsize=(8, 4))\nax = plt.gca()  # è·å–å½“å‰çš„è½´å¯¹è±¡\nplot_pacf(np.diff(np.log(data[\"value\"])), ax=ax, lags=30)\nax.set_ylim(-0.25, 1)\nax.set_xlabel('Lag', fontsize=16)  # è®¾ç½®æ¨ªè½´æ ‡ç­¾\nplt.title('')\nplt.show()\n\n\n\n\n\n\n\n\n\nPACF è™½ç„¶åœ¨ ğ‘˜ = 3, 9, 14, 16 ç­‰ä½ç½®è¶…å‡ºç•Œé™ï¼Œä½†æ˜¯è¶…å‡ºä¸å¤šï¼Œå¯è€ƒè™‘ç”¨ AR(3) å»ºæ¨¡ã€‚",
    "crumbs": [
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>è‡ªå›å½’æ¨¡å‹</span>"
    ]
  }
]